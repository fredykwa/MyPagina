<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduHub - Plataforma Educativa Profesional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .content-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .admin-panel { transform: translateX(100%); transition: transform 0.3s ease; }
        .admin-panel.open { transform: translateX(0); }
        .admin-mode { border: 2px solid #10b981; background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .login-key { position: fixed; bottom: 20px; right: 20px; z-index: 30; }
        .embed-container { position: relative; width: 100%; height: 0; padding-bottom: 56.25%; }
        .embed-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
                        <span class="text-2xl">üìö</span>
                    </div>
                    <h1 class="text-2xl font-bold">EduHub</h1>
                </div>
                <nav class="hidden md:flex space-x-6 items-center">
                    <a href="#inicio" class="hover:text-blue-200 transition-colors">Inicio</a>
                    <a href="#contenido" class="hover:text-blue-200 transition-colors">Contenido</a>
                    <a href="#recursos" class="hover:text-blue-200 transition-colors">Recursos</a>
                    <!-- Admin Controls (Hidden by default) -->
                    <button id="adminBtn" onclick="toggleAdminPanel()" class="hidden bg-white bg-opacity-20 px-4 py-2 rounded-lg hover:bg-opacity-30 transition-colors">
                        ‚öôÔ∏è Admin
                    </button>
                    <button id="logoutBtn" onclick="logout()" class="hidden bg-red-500 px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-white font-medium">
                        üë§ Cerrar Sesi√≥n
                    </button>
                </nav>
                <button class="md:hidden text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Admin Mode Indicator (Now below header) -->
    <div id="adminIndicator" class="hidden bg-green-600 text-white text-center py-2">
        <span class="pulse">üîß MODO ADMINISTRADOR ACTIVO</span>
    </div>

    <!-- Login Key (Discrete) -->
    <button id="loginKey" onclick="showLoginModal()" class="login-key bg-gray-600 hover:bg-gray-700 text-white w-12 h-12 rounded-full shadow-lg transition-colors flex items-center justify-center">
        üîë
    </button>

    <!-- Hero Section -->
    <section id="inicio" class="gradient-bg text-white py-20">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-5xl font-bold mb-6">Plataforma Educativa Profesional</h2>
            <p class="text-xl mb-8 max-w-3xl mx-auto">Accede a contenido educativo de alta calidad: animaciones interactivas, simulaciones, videos, documentos PDF e im√°genes educativas.</p>
            <button onclick="scrollToContent()" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors">
                Explorar Contenido
            </button>
        </div>
    </section>

    <!-- Content Categories -->
    <section id="contenido" class="py-16">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center mb-12 text-gray-800">Categor√≠as de Contenido</h2>
            
            <!-- Category Tabs -->
            <div class="flex flex-wrap justify-center mb-8 space-x-2">
                <button onclick="showCategory('all')" class="category-btn active bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors mb-2">
                    Todos (<span id="count-all">0</span>)
                </button>
                <button onclick="showCategory('animations')" class="category-btn bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors mb-2">
                    Animaciones (<span id="count-animations">0</span>)
                </button>
                <button onclick="showCategory('simulations')" class="category-btn bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors mb-2">
                    Simulaciones (<span id="count-simulations">0</span>)
                </button>
                <button onclick="showCategory('videos')" class="category-btn bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors mb-2">
                    Videos (<span id="count-videos">0</span>)
                </button>
                <button onclick="showCategory('documents')" class="category-btn bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors mb-2">
                    Documentos (<span id="count-documents">0</span>)
                </button>
                <button onclick="showCategory('images')" class="category-btn bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors mb-2">
                    Im√°genes (<span id="count-images">0</span>)
                </button>
            </div>

            <!-- Content Grid -->
            <div id="content-grid" class="content-grid">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="text-center py-16 hidden">
                <div class="text-6xl mb-4">üìö</div>
                <h3 class="text-2xl font-semibold text-gray-600 mb-2">No hay contenido a√∫n</h3>
                <p class="text-gray-500 mb-6">El contenido educativo aparecer√° aqu√≠ una vez que sea agregado.</p>
                <div id="emptyStateAdmin" class="hidden">
                    <button onclick="toggleAdminPanel()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        ‚ûï Agregar Primer Contenido
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="recursos" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center mb-12 text-gray-800">Caracter√≠sticas de la Plataforma</h2>
            <div class="grid md:grid-cols-4 gap-8">
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">‚ö°</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Acceso R√°pido</h3>
                    <p class="text-gray-600">Contenido optimizado para carga r√°pida y navegaci√≥n fluida.</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">üéØ</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Contenido Curado</h3>
                    <p class="text-gray-600">Materiales educativos seleccionados por expertos.</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">üì±</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Multiplataforma</h3>
                    <p class="text-gray-600">Compatible con todos los dispositivos modernos.</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">üîí</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Gesti√≥n Segura</h3>
                    <p class="text-gray-600">Sistema de administraci√≥n protegido y profesional.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                            <span class="text-lg">üìö</span>
                        </div>
                        <h3 class="text-xl font-bold">EduHub</h3>
                    </div>
                    <p class="text-gray-400">Plataforma educativa profesional para el aprendizaje interactivo y multimedia.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Enlaces R√°pidos</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#inicio" class="hover:text-white transition-colors">Inicio</a></li>
                        <li><a href="#contenido" class="hover:text-white transition-colors">Contenido</a></li>
                        <li><a href="#recursos" class="hover:text-white transition-colors">Recursos</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Estad√≠sticas</h4>
                    <p class="text-gray-400 mb-2">üìä Total de contenido: <span id="total-content">0</span></p>
                    <p class="text-gray-400 mb-2">üìÖ √öltima actualizaci√≥n: <span id="last-update">Nunca</span></p>
                    <div id="adminStats" class="hidden mt-4 text-green-400">
                        <p class="text-sm">üîß Sesi√≥n de administrador activa</p>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 EduHub. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-md w-full p-6">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-2xl">üîê</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Acceso de Administrador</h3>
                <p class="text-gray-600">Ingresa la contrase√±a para gestionar el contenido</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label>
                    <input type="password" id="adminPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ingresa tu contrase√±a" required>
                </div>
                
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                        üîì Iniciar Sesi√≥n
                    </button>
                    <button type="button" onclick="closeLoginModal()" class="flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-400 transition-colors">
                        Cancelar
                    </button>
                </div>
            </form>

            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h4 class="font-semibold text-blue-800 mb-2">üí° Configuraci√≥n Inicial</h4>
                <p class="text-sm text-blue-700 mb-3">La contrase√±a por defecto es: <code class="bg-blue-200 px-2 py-1 rounded">admin123</code></p>
                <p class="text-xs text-blue-600">Puedes cambiarla desde el panel de administraci√≥n una vez que inicies sesi√≥n.</p>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel fixed top-0 right-0 h-full w-96 bg-white shadow-2xl z-50 overflow-y-auto">
        <div class="p-6 border-b border-gray-200 admin-mode">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-white">üîß Panel de Admin</h2>
                <button onclick="toggleAdminPanel()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
            </div>
        </div>

        <!-- Password Change Section -->
        <div class="p-6 border-b border-gray-200 bg-yellow-50">
            <h3 class="text-lg font-semibold mb-4 text-yellow-800">üîê Cambiar Contrase√±a</h3>
            <form id="passwordForm" class="space-y-3">
                <input type="password" id="newPassword" class="w-full px-3 py-2 border border-yellow-300 rounded-lg focus:ring-2 focus:ring-yellow-500" placeholder="Nueva contrase√±a" required>
                <button type="submit" class="w-full bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors">
                    üîÑ Actualizar Contrase√±a
                </button>
            </form>
        </div>

        <!-- Add Content Form -->
        <div class="p-6">
            <h3 class="text-lg font-semibold mb-4">‚ûï Agregar Nuevo Contenido</h3>
            <form id="contentForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">T√≠tulo</label>
                    <input type="text" id="contentTitle" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ej: Animaci√≥n del Sistema Solar" required>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descripci√≥n</label>
                    <textarea id="contentDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Describe brevemente el contenido..." required></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Categor√≠a</label>
                    <select id="contentCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                        <option value="">Selecciona una categor√≠a</option>
                        <option value="animations">Animaciones</option>
                        <option value="simulations">Simulaciones</option>
                        <option value="videos">Videos</option>
                        <option value="documents">Documentos</option>
                        <option value="images">Im√°genes</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Contenido</label>
                    <select id="contentType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleContentFields()" required>
                        <option value="url">üîó Enlace Externo</option>
                        <option value="embed">üì∫ C√≥digo Embed (Incrustado)</option>
                    </select>
                </div>

                <div id="urlField">
                    <label class="block text-sm font-medium text-gray-700 mb-2">URL/Enlace</label>
                    <input type="url" id="contentUrl" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="https://ejemplo.com/recurso">
                    <p class="text-xs text-gray-500 mt-1">üåê Enlace a una p√°gina web externa</p>
                </div>

                <div id="embedField" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">C√≥digo Embed</label>
                    <textarea id="contentEmbed" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm" placeholder='<iframe src="https://www.youtube.com/embed/VIDEO_ID" width="560" height="315" frameborder="0" allowfullscreen></iframe>'></textarea>
                    <p class="text-xs text-gray-500 mt-1">üì∫ Pega aqu√≠ el c√≥digo embed de YouTube, Vimeo, simulaciones, etc.</p>
                    <div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-700">
                        <strong>üí° Ejemplos:</strong><br>
                        ‚Ä¢ YouTube: Compartir ‚Üí Insertar ‚Üí Copia el c√≥digo<br>
                        ‚Ä¢ Vimeo: Compartir ‚Üí Insertar ‚Üí Copia el c√≥digo<br>
                        ‚Ä¢ Simulaciones PhET: Usar el bot√≥n "Embed"
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Emoji/Icono</label>
                    <input type="text" id="contentIcon" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="üé¨" maxlength="2">
                </div>

                <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                    ‚ûï Agregar Contenido
                </button>
            </form>
        </div>

        <!-- Content Management -->
        <div class="p-6 border-t border-gray-200">
            <h3 class="text-lg font-semibold mb-4">üìã Gestionar Contenido</h3>
            <div id="contentList" class="space-y-3">
                <!-- Content items will be listed here -->
            </div>
        </div>

        <!-- Bulk Actions -->
        <div class="p-6 border-t border-gray-200">
            <h3 class="text-lg font-semibold mb-4">üîß Acciones</h3>
            <div class="space-y-2">
                <button onclick="exportContent()" class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                    üì§ Exportar Contenido
                </button>
                <button onclick="importContent()" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors">
                    üì• Importar Contenido
                </button>
                <button onclick="clearAllContent()" class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors">
                    üóëÔ∏è Limpiar Todo
                </button>
            </div>
        </div>
    </div>

    <!-- Content Modal -->
    <div id="contentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h3 id="modalTitle" class="text-2xl font-bold text-gray-800"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="modalContent" class="p-6">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Hidden file input for import -->
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport(event)">

    <script>
        // Authentication and content storage
        let isAdminMode = false;
        let adminPassword = 'admin123'; // Default password
        
        // Load saved password on startup
        function loadSavedPassword() {
            const savedPassword = localStorage.getItem('eduHubPassword');
            if (savedPassword) {
                adminPassword = savedPassword;
                console.log('Contrase√±a personalizada cargada correctamente');
            } else {
                console.log('Usando contrase√±a por defecto: admin123');
            }
        }
        let contentData = JSON.parse(localStorage.getItem('eduHubContent')) || [
            {
                id: 'pendulo-simple',
                title: 'P√©ndulo Simple - Simulaci√≥n Interactiva',
                description: 'Simulaci√≥n interactiva del movimiento de un p√©ndulo simple. Puedes ajustar la longitud, masa y √°ngulo inicial para observar c√≥mo cambia el per√≠odo de oscilaci√≥n.',
                category: 'simulations',
                embed: '<iframe src="https://phet.colorado.edu/sims/html/pendulum-lab/latest/pendulum-lab_es.html" width="100%" height="400" frameborder="0" allowfullscreen></iframe>',
                icon: '‚öñÔ∏è',
                type: 'embed',
                createdAt: '2024-01-15T10:00:00.000Z'
            },
            {
                id: 'sistema-solar',
                title: 'Sistema Solar Interactivo',
                description: 'Explora los planetas del sistema solar con esta animaci√≥n interactiva. Descubre datos fascinantes sobre cada planeta.',
                category: 'animations',
                url: 'https://solarsystem.nasa.gov/solar-system/our-solar-system/overview/',
                icon: 'ü™ê',
                type: 'url',
                createdAt: '2024-01-14T09:30:00.000Z'
            },
            {
                id: 'tabla-periodica',
                title: 'Tabla Peri√≥dica Interactiva',
                description: 'Tabla peri√≥dica interactiva con informaci√≥n detallada de cada elemento qu√≠mico.',
                category: 'simulations',
                url: 'https://ptable.com/?lang=es',
                icon: 'üß™',
                type: 'url',
                createdAt: '2024-01-13T14:20:00.000Z'
            }
        ];

        // Category colors and icons
        const categoryStyles = {
            animations: { bg: 'from-purple-400 to-pink-400', color: 'purple', icon: 'üé¨' },
            simulations: { bg: 'from-green-400 to-blue-400', color: 'green', icon: '‚öóÔ∏è' },
            videos: { bg: 'from-red-400 to-orange-400', color: 'red', icon: 'üé•' },
            documents: { bg: 'from-indigo-400 to-purple-400', color: 'indigo', icon: 'üìÑ' },
            images: { bg: 'from-yellow-400 to-orange-400', color: 'yellow', icon: 'üñºÔ∏è' }
        };

        // Initialize the app
        function initApp() {
            loadSavedPassword(); // Load saved password first
            renderContent();
            updateCounts();
            updateStats();
            updateUIMode();
        }

        // Toggle content type fields
        function toggleContentFields() {
            const contentType = document.getElementById('contentType').value;
            const urlField = document.getElementById('urlField');
            const embedField = document.getElementById('embedField');
            const urlInput = document.getElementById('contentUrl');
            const embedInput = document.getElementById('contentEmbed');
            
            if (contentType === 'embed') {
                urlField.classList.add('hidden');
                embedField.classList.remove('hidden');
                urlInput.required = false;
                embedInput.required = true;
                // Clear URL field when switching to embed
                urlInput.value = '';
            } else {
                urlField.classList.remove('hidden');
                embedField.classList.add('hidden');
                urlInput.required = false; // URL is optional for external links too
                embedInput.required = false;
                // Clear embed field when switching to URL
                embedInput.value = '';
            }
        }

        // Authentication functions
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('adminPassword').focus();
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
        }

        function login(password) {
            if (password === adminPassword) {
                isAdminMode = true;
                updateUIMode();
                closeLoginModal();
                showWelcomeMessage();
                return true;
            }
            return false;
        }

        function logout() {
            console.log('Logout function called'); // Debug
            if (confirm('¬øEst√°s seguro de que quieres cerrar la sesi√≥n de administrador?')) {
                isAdminMode = false;
                updateUIMode();
                document.getElementById('adminPanel').classList.remove('open');
                showLogoutMessage();
            }
        }

        function updateUIMode() {
            const adminBtn = document.getElementById('adminBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const loginKey = document.getElementById('loginKey');
            const adminIndicator = document.getElementById('adminIndicator');
            const adminStats = document.getElementById('adminStats');
            const emptyStateAdmin = document.getElementById('emptyStateAdmin');

            if (isAdminMode) {
                // Show admin controls
                adminBtn.classList.remove('hidden');
                logoutBtn.classList.remove('hidden');
                loginKey.classList.add('hidden');
                adminIndicator.classList.remove('hidden');
                adminStats.classList.remove('hidden');
                emptyStateAdmin.classList.remove('hidden');
                
                // Re-render content with admin controls
                renderContent();
                renderContentList();
            } else {
                // Hide admin controls
                adminBtn.classList.add('hidden');
                logoutBtn.classList.add('hidden');
                loginKey.classList.remove('hidden');
                adminIndicator.classList.add('hidden');
                adminStats.classList.add('hidden');
                emptyStateAdmin.classList.add('hidden');
                
                // Re-render content without admin controls
                renderContent();
            }
        }

        function showWelcomeMessage() {
            const message = document.createElement('div');
            message.className = 'fixed top-20 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            message.innerHTML = 'üéâ ¬°Bienvenido, Administrador!';
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 3000);
        }

        function showLogoutMessage() {
            const message = document.createElement('div');
            message.className = 'fixed top-20 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            message.innerHTML = 'üëã Sesi√≥n cerrada correctamente';
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 3000);
        }

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            
            if (login(password)) {
                // Success handled in login function
            } else {
                // Show error
                const errorMsg = document.createElement('div');
                errorMsg.className = 'mt-3 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg';
                errorMsg.textContent = '‚ùå Contrase√±a incorrecta. Int√©ntalo de nuevo.';
                
                const existingError = this.querySelector('.bg-red-100');
                if (existingError) existingError.remove();
                
                this.appendChild(errorMsg);
                setTimeout(() => errorMsg.remove(), 3000);
            }
        });

        // Password change form handler
        document.getElementById('passwordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newPassword = document.getElementById('newPassword').value;
            
            if (newPassword.length < 6) {
                alert('‚ùå La contrase√±a debe tener al menos 6 caracteres');
                return;
            }
            
            adminPassword = newPassword;
            localStorage.setItem('eduHubPassword', adminPassword);
            document.getElementById('newPassword').value = '';
            
            const message = document.createElement('div');
            message.className = 'fixed top-20 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            message.innerHTML = 'üîê Contrase√±a actualizada correctamente';
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 3000);
        });

        // Toggle admin panel
        function toggleAdminPanel() {
            if (!isAdminMode) {
                showLoginModal();
                return;
            }
            
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('open');
        }

        // Add new content
        document.getElementById('contentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('contentTitle').value;
            const description = document.getElementById('contentDescription').value;
            const category = document.getElementById('contentCategory').value;
            const contentType = document.getElementById('contentType').value;
            const url = document.getElementById('contentUrl').value;
            const embed = document.getElementById('contentEmbed').value;
            const icon = document.getElementById('contentIcon').value;

            const newContent = {
                id: Date.now().toString(),
                title,
                description,
                category,
                type: contentType,
                url: contentType === 'url' ? url : '',
                embed: contentType === 'embed' ? embed : '',
                icon: icon || categoryStyles[category]?.icon || 'üìö',
                createdAt: new Date().toISOString()
            };

            contentData.push(newContent);
            saveContent();
            renderContent();
            updateCounts();
            updateStats();
            renderContentList();

            // Reset form
            this.reset();
            toggleContentFields(); // Reset field visibility
            
            // Show success message
            const message = document.createElement('div');
            message.className = 'fixed top-20 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            message.innerHTML = '‚úÖ Contenido agregado exitosamente';
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 3000);
        });

        // Save content to localStorage
        function saveContent() {
            localStorage.setItem('eduHubContent', JSON.stringify(contentData));
        }

        // Render content grid
        function renderContent() {
            const grid = document.getElementById('content-grid');
            const emptyState = document.getElementById('empty-state');

            if (contentData.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');

            grid.innerHTML = contentData.map(item => {
                const style = categoryStyles[item.category] || categoryStyles.documents;
                const deleteButton = isAdminMode ? `
                    <button onclick="deleteContent('${item.id}')" class="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full hover:bg-red-600 transition-colors text-sm">
                        √ó
                    </button>
                ` : '';
                
                const contentTypeIcon = item.type === 'embed' ? 'üì∫' : 'üîó';
                
                return `
                    <div class="content-item ${item.category} bg-white rounded-xl shadow-lg overflow-hidden card-hover" data-id="${item.id}">
                        <div class="h-48 bg-gradient-to-br ${style.bg} flex items-center justify-center relative">
                            <span class="text-6xl">${item.icon}</span>
                            <div class="absolute bottom-2 left-2 bg-white bg-opacity-20 rounded-full w-8 h-8 flex items-center justify-center">
                                <span class="text-sm">${contentTypeIcon}</span>
                            </div>
                            ${deleteButton}
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-semibold mb-2">${item.title}</h3>
                            <p class="text-gray-600 mb-4">${item.description}</p>
                            <div class="flex justify-between items-center">
                                <span class="bg-${style.color}-100 text-${style.color}-800 px-3 py-1 rounded-full text-sm capitalize">
                                    ${item.category.replace('s', '')}
                                </span>
                                <button onclick="openContent('${item.id}')" class="text-blue-600 hover:text-blue-800 font-medium">
                                    ${item.type === 'embed' ? 'Ver ‚Üí' : 'Abrir ‚Üí'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update category counts
        function updateCounts() {
            const counts = {
                all: contentData.length,
                animations: contentData.filter(item => item.category === 'animations').length,
                simulations: contentData.filter(item => item.category === 'simulations').length,
                videos: contentData.filter(item => item.category === 'videos').length,
                documents: contentData.filter(item => item.category === 'documents').length,
                images: contentData.filter(item => item.category === 'images').length
            };

            Object.keys(counts).forEach(category => {
                const element = document.getElementById(`count-${category}`);
                if (element) element.textContent = counts[category];
            });
        }

        // Update stats
        function updateStats() {
            document.getElementById('total-content').textContent = contentData.length;
            const lastUpdate = contentData.length > 0 ? 
                new Date(Math.max(...contentData.map(item => new Date(item.createdAt)))).toLocaleDateString('es-ES') : 
                'Nunca';
            document.getElementById('last-update').textContent = lastUpdate;
        }

        // Category filtering
        function showCategory(category) {
            const items = document.querySelectorAll('.content-item');
            const buttons = document.querySelectorAll('.category-btn');
            
            // Update button styles
            buttons.forEach(btn => {
                btn.classList.remove('active', 'bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            event.target.classList.add('active', 'bg-blue-600', 'text-white');
            event.target.classList.remove('bg-gray-200', 'text-gray-700');
            
            // Show/hide items
            items.forEach(item => {
                if (category === 'all' || item.classList.contains(category)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Open content
        function openContent(contentId) {
            const item = contentData.find(content => content.id === contentId);
            if (!item) return;

            const modal = document.getElementById('contentModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');

            title.textContent = item.title;
            
            const style = categoryStyles[item.category] || categoryStyles.documents;
            
            if (item.type === 'embed' && item.embed) {
                // Show embedded content
                content.innerHTML = `
                    <div class="text-center mb-6">
                        <div class="bg-gradient-to-br ${style.bg} rounded-lg p-6 mb-4">
                            <span class="text-6xl">${item.icon}</span>
                            <p class="text-white text-lg mt-2">${item.title}</p>
                        </div>
                        <p class="text-gray-600 mb-6">${item.description}</p>
                    </div>
                    <div class="embed-container bg-gray-100 rounded-lg overflow-hidden">
                        ${item.embed}
                    </div>
                    <div class="mt-6 text-sm text-gray-400 text-center">
                        üì∫ Contenido incrustado ‚Ä¢ Creado el: ${new Date(item.createdAt).toLocaleDateString('es-ES')}
                    </div>
                `;
            } else {
                // Show external link content
                content.innerHTML = `
                    <div class="text-center">
                        <div class="bg-gradient-to-br ${style.bg} rounded-lg p-8 mb-6">
                            <span class="text-8xl">${item.icon}</span>
                            <p class="text-white text-lg mt-4">${item.title}</p>
                        </div>
                        <p class="text-gray-600 mb-6">${item.description}</p>
                        ${item.url ? `
                            <a href="${item.url}" target="_blank" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors inline-block">
                                üîó Abrir Recurso
                            </a>
                        ` : `
                            <p class="text-gray-500 italic">Este contenido no tiene un enlace asociado.</p>
                        `}
                        <div class="mt-6 text-sm text-gray-400">
                            Creado el: ${new Date(item.createdAt).toLocaleDateString('es-ES')}
                        </div>
                    </div>
                `;
            }

            modal.classList.remove('hidden');
        }

        // Delete content
        function deleteContent(contentId) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este contenido?')) {
                contentData = contentData.filter(item => item.id !== contentId);
                saveContent();
                renderContent();
                updateCounts();
                updateStats();
                renderContentList();
                
                const message = document.createElement('div');
                message.className = 'fixed top-20 right-4 bg-orange-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                message.innerHTML = 'üóëÔ∏è Contenido eliminado';
                document.body.appendChild(message);
                setTimeout(() => message.remove(), 3000);
            }
        }

        // Render content list in admin panel
        function renderContentList() {
            if (!isAdminMode) return;
            
            const list = document.getElementById('contentList');
            
            if (contentData.length === 0) {
                list.innerHTML = '<p class="text-gray-500 text-center py-4">No hay contenido para gestionar</p>';
                return;
            }

            list.innerHTML = contentData.map(item => `
                <div class="bg-gray-50 p-3 rounded-lg">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-medium text-sm">${item.title}</h4>
                            <p class="text-xs text-gray-500 capitalize">${item.category} ‚Ä¢ ${item.type === 'embed' ? 'Incrustado' : 'Enlace'}</p>
                        </div>
                        <button onclick="deleteContent('${item.id}')" class="text-red-500 hover:text-red-700 text-sm ml-2">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Export content
        function exportContent() {
            const dataStr = JSON.stringify(contentData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'eduhub-content.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        // Import content
        function importContent() {
            document.getElementById('importFile').click();
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    if (Array.isArray(importedData)) {
                        contentData = importedData;
                        saveContent();
                        renderContent();
                        updateCounts();
                        updateStats();
                        renderContentList();
                        
                        const message = document.createElement('div');
                        message.className = 'fixed top-20 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                        message.innerHTML = 'üì• Contenido importado exitosamente';
                        document.body.appendChild(message);
                        setTimeout(() => message.remove(), 3000);
                    } else {
                        alert('‚ùå Formato de archivo inv√°lido');
                    }
                } catch (error) {
                    alert('‚ùå Error al importar el archivo');
                }
            };
            reader.readAsText(file);
        }

        // Clear all content
        function clearAllContent() {
            if (confirm('¬øEst√°s seguro de que quieres eliminar TODO el contenido? Esta acci√≥n no se puede deshacer.')) {
                contentData = [];
                saveContent();
                renderContent();
                updateCounts();
                updateStats();
                renderContentList();
                
                const message = document.createElement('div');
                message.className = 'fixed top-20 right-4 bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                message.innerHTML = 'üóëÔ∏è Todo el contenido eliminado';
                document.body.appendChild(message);
                setTimeout(() => message.remove(), 3000);
            }
        }

        // Close modal
        function closeModal() {
            document.getElementById('contentModal').classList.add('hidden');
        }

        // Scroll to content
        function scrollToContent() {
            document.getElementById('contenido').scrollIntoView({ behavior: 'smooth' });
        }

        // Close modal when clicking outside
        document.getElementById('contentModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Close login modal when clicking outside
        document.getElementById('loginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLoginModal();
            }
        });

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97fd4e3f10c53bf3',t:'MTc1Nzk5MzY0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
